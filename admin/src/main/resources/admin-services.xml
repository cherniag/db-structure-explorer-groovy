<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:utils="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

    <bean name="mobileApplicationPagesService" class="mobi.nowtechnologies.server.service.streamzine.MobileApplicationPagesService">
        <constructor-arg>
            <value>file:#{systemProperties['catalina.base']}/conf/streamzine/pages.txt</value>
        </constructor-arg>
        <constructor-arg>
            <value>file:#{systemProperties['catalina.base']}/conf/streamzine/actions.txt</value>
        </constructor-arg>
    </bean>

    <bean id="settingsAsm" class="mobi.nowtechnologies.server.admin.settings.asm.SettingsAsm">
        <property name="messageSource" ref="messageSource" />
        <property name="settingsService" ref="settingsService" />
    </bean>

    <bean id="badgesDtoConverter" class="mobi.nowtechnologies.server.dto.streamzine.badge.BadgesDtoAsm">

    </bean>

    <bean name="errorDtoAsm" class="mobi.nowtechnologies.server.dto.streamzine.error.ErrorDtoAsm">
        <property name="messageSource" ref="messageSource" />
    </bean>

    <bean name="streamzineAdminMediaAsm" class="mobi.nowtechnologies.server.service.streamzine.asm.StreamzineAdminMediaAsm">
        <property name="chartService" ref="service.ChartService"/>
    </bean>

    <bean name="streamzineUpdateAdminAsm" class="mobi.nowtechnologies.server.service.streamzine.asm.StreamzineUpdateAdminAsm">
        <property name="messageSource" ref="messageSource" />
        <property name="deepLinkInfoService" ref="deepLinkInfoService" />
        <property name="userRepository" ref="userRepository"/>
        <property name="streamzineAdminMediaAsm" ref="streamzineAdminMediaAsm"/>
        <property name="communityRepository" ref="communityRepository"/>
        <property name="filenameAliasRepository" ref="filenameAliasRepository"/>
    </bean>

    <bean name="typesMappingAsm" class="mobi.nowtechnologies.server.service.streamzine.asm.TypesMappingAsm">
        <property name="messageSource" ref="messageSource" />
    </bean>

    <bean name="rulesInfoAsm" class="mobi.nowtechnologies.server.service.streamzine.asm.RulesInfoAsm" />

    <bean name="streamzineTypesMappingService" class="mobi.nowtechnologies.server.service.streamzine.StreamzineTypesMappingService">
    </bean>

    <bean id="adminUserService" class="mobi.nowtechnologies.server.service.impl.AdminUserServiceImpl">
        <property name="dataSource" ref="securityDataSource"/>
    </bean>

    <bean id="duplicatedMediaAcrossNearestChartsDtoAssembler" class="mobi.nowtechnologies.server.admin.asm.DuplicatedMediaAcrossNearestChartsDtoAssembler" />

    <bean id="communityDtoAsm" class="mobi.nowtechnologies.server.dto.asm.CommunityDtoAsm"/>
    <bean id="settingsService" class="mobi.nowtechnologies.server.admin.settings.service.SettingsService">
        <property name="communityRepository" ref="communityRepository" />
        <property name="communityConfigRepository" ref="communityConfigRepository" />
        <property name="behaviorConfigRepository" ref="behaviorConfigRepository" />
        <property name="chartUserStatusBehaviorRepository" ref="chartUserStatusBehaviorRepository" />
    </bean>

    <bean id="admin.ChartAsm" class="mobi.nowtechnologies.server.admin.asm.ChartAsm">
        <property name="filenameAliasRepository" ref="filenameAliasRepository"/>
    </bean>

    <!-- Application Message Bundle -->
    <bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="basenames" ref="messagesBaseName" />
        <property name="defaultEncoding" value="UTF-8" />
        <property name="fileEncodings" value="UTF-8" />
        <property name="cacheSeconds" value="180" />
        <property name="useCodeAsDefaultMessage" value="true" />
    </bean>

    <utils:list id="messagesBaseName">
        <value>file:#{systemProperties['catalina.base']}/conf/#{systemProperties['env']}/i18n/admin/messages</value>
        <value>/i18n/messages</value>
    </utils:list>

    <alias name="messageSource" alias="rootMessageSource"/>

    <beans profile="TEST">
        <utils:list id="messagesBaseName">
            <value>classpath:i18n/messages</value>
        </utils:list>
    </beans>
</beans>